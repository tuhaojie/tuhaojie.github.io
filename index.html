<!DOCTYPE html>  
<html lang="zh-CN">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <title>页面标题</title>  
    <!-- 这里可以添加其他的头部信息，比如CSS样式表链接、JavaScript脚本链接等 -->  
    <link rel="stylesheet" href="styles.css">
<style>  
        table {  
            border-collapse: collapse;  
            width: 100%;  
        }  
        th, td {  
            text-align: left;  
            padding: 8px;  
            border-bottom: 1px solid #5f4f4f;  
        }  
        tr:hover {background-color: #f5f5f5;}  
    </style>  	
	    <script>
	        function fetchData() {  
            // API接口的URL  
            var url = 'https://webapi.sporttery.cn/gateway/jc/football/getMatchCalculatorV1.qry?poolCode=hhad,had&channel=c';  
  
            // 创建一个新的HTTP请求  
            var xhr = new XMLHttpRequest();  
  
            // 定义请求完成后的回调函数  
            xhr.onload = function() {  
                if (xhr.status === 200) {  
                    // 请求成功，处理返回的数据  
                    var data = JSON.parse(xhr.responseText);  
                    console.log(data);  
					var matchIds = ''; 
                    // 你可以在这里将数据插入到HTML元素中，或者执行其他操作 
					var value = data.value;
					var matchInfoList = value.matchInfoList;
					var subMatchList = matchInfoList[0].subMatchList;
					subMatchList.forEach(item => { 
					matchIds = matchIds + item.matchId + ','
					});
					var url2 = 'https://webapi.sporttery.cn/gateway/jc/common/getSupportRateV1.qry?matchIds='+matchIds+'&poolCode=hhad,had&sportType=1';  
					 // 创建一个新的HTTP请求  
                    var xhr2 = new XMLHttpRequest();  
					xhr2.onload = function() {  
                         if (xhr2.status === 200) {  
						    var data2 = JSON.parse(xhr2.responseText);  
						    console.log(data2); 
												const tableBody = document.getElementById('table-body');  
					 tableBody.innerHTML = '';  
					 // 遍历数据并创建表格行  
				var value2 = data2.value;
                subMatchList.forEach(item => {  
					const had = value2['_'+item.matchId].HAD;
					const hhad = value2['_'+item.matchId].HHAD
                    var h = item.had.h == undefined ? '/':item.had.h
                    var d = item.had.d == undefined ? '/':item.had.d
                    var a = item.had.a == undefined ? '/':item.had.a
					var hProbability = had == undefined ? '/':had.hProbability
                    var dProbability = had == undefined ? '/':had.dProbability
                    var aProbability = had == undefined ? '/':had.aProbability
                    var hSupportRate = had == undefined ? '/':had.hSupportRate
                    var dSupportRate = had == undefined ? '/':had.dSupportRate
                    var aSupportRate = had == undefined ? '/':had.aSupportRate
					var win = had == undefined ? '/':had.win
                    var draw = had == undefined ? '/':had.draw
                    var lose = had == undefined ? '/':had.lose	
					var total = had == undefined ? '/':had.win+had.draw+had.lose
					var winM = had == undefined ? '/':count(had.win,h,'*')
                    var drawM = had == undefined ? '/':count(had.draw,d,'*')
                    var loseM = had == undefined ? '/':count(had.lose,a,'*')
					var winY = had == undefined ? '/':count(total,winM,'-')
                    var drawY = had == undefined ? '/':count(total,drawM,'-')
                    var loseY = had == undefined ? '/':count(total,loseM,'-')
                    var hhSupportRate = hhad == undefined ? '/':hhad.hSupportRate
                    var hdSupportRate = hhad == undefined ? '/':hhad.dSupportRate
                    var haSupportRate = hhad == undefined ? '/':hhad.aSupportRate	
					var hwin = hhad == undefined ? '/':hhad.win
                    var hdraw = hhad == undefined ? '/':hhad.draw
                    var hlose = hhad == undefined ? '/':hhad.lose	
					var htotal = hhad == undefined ? '/':hhad.win+hhad.draw+hhad.lose
					var hwinM = hhad == undefined ? '/':count(hhad.win,item.hhad.h,'*')
                    var hdrawM = hhad == undefined ? '/':count(hhad.draw,item.hhad.d,'*')
                    var hloseM = hhad == undefined ? '/':count(hhad.lose,item.hhad.a,'*')
					var hwinY = hhad == undefined ? '/':count(htotal,hwinM,'-')
                    var hdrawY = hhad == undefined ? '/':count(htotal,hdrawM,'-')
                    var hloseY = hhad == undefined ? '/':count(htotal,hloseM,'-')
                    const row1 = document.createElement('tr');
                    const row2 = document.createElement('tr');
                    const row3 = document.createElement('tr');
                    const row4 = document.createElement('tr');
                    const row5 = document.createElement('tr');
                    const row6 = document.createElement('tr');
                    const row7 = document.createElement('tr');
                    const row8 = document.createElement('tr');					
                    row1.innerHTML = `  
                        <td>${item.matchNumStr}</td>  
                        <td>${item.homeTeamAbbName}</td> 
                        <td></td>						
                        <td>${item.awayTeamAbbName}</td>
                        <td></td>
                    `;
                    row2.innerHTML = `  
                        <td>支持量比例</td>  
                        <td>${hSupportRate}</td> 
                        <td>${dSupportRate}</td>						
                        <td>${aSupportRate}</td>
                        <td></td>
                    `; 					
					row3.innerHTML = `  
                        <td>赔率</td>  
                        <td>${h}</td> 
                        <td>${d}</td>						
                        <td>${a}</td>
                        <td></td>
                    `;
                    row4.innerHTML = `  
                        <td>赔率胜率</td>  
                        <td>${hProbability}</td> 
                        <td>${dProbability}</td>						
                        <td>${aProbability}</td>
                        <td></td>
                    `;
                     row5.innerHTML = `  
                        <td>支持量</td>  
                        <td>${win}</td> 
                        <td>${draw}</td>						
                        <td>${lose}</td>
                        <td></td>
                    `;
                    row6.innerHTML = `  
                        <td>总奖池</td>  
                        <td colspan="3" style="text-align: center; vertical-align: middle; ">${total}</td> 
                        <td></td>
                    `;
                    row7.innerHTML = `  
                        <td>奖池赔付</td>  
                        <td>${winM}</td> 
                        <td>${drawM}</td>						
                        <td>${loseM}</td>
                        <td></td>
                    `;
                     row8.innerHTML = `  
                        <td>庄家盈亏</td>  
                        <td>${winY}</td> 
                        <td>${drawY}</td>						
                        <td>${loseY}</td>
                        <td></td>
                    `;
                    const row9 = document.createElement('tr');
                    const row10 = document.createElement('tr');
                    const row11 = document.createElement('tr');
                    const row12 = document.createElement('tr');
                    const row13 = document.createElement('tr');
                    const row14 = document.createElement('tr');
                    const row15 = document.createElement('tr');
                    const row16 = document.createElement('tr');					
                    row10.innerHTML = `  
                        <td>${item.hhad.goalLine}支持量比例</td>  
                        <td>${hhSupportRate}</td> 
                        <td>${hdSupportRate}</td>						
                        <td>${haSupportRate}</td>
                        <td></td>
                    `; 					
					row11.innerHTML = `  
                        <td>赔率</td>  
                        <td>${item.hhad.h}</td> 
                        <td>${item.hhad.d}</td>						
                        <td>${item.hhad.a}</td>
                        <td></td>
                    `;
                    row12.innerHTML = `  
                        <td>赔率胜率</td>  
                        <td>${hhad.hProbability}</td> 
                        <td>${hhad.dProbability}</td>						
                        <td>${hhad.aProbability}</td>
                        <td></td>
                    `;
                     row13.innerHTML = `  
                        <td>支持量</td>  
                        <td>${hwin}</td> 
                        <td>${hdraw}</td>						
                        <td>${hlose}</td>
                        <td></td>
                    `;
                    row14.innerHTML = `  
                        <td>总奖池</td>  
                        <td colspan="3" style="text-align: center; vertical-align: middle; ">${htotal}</td> 
                        <td></td>
                    `;
                    row15.innerHTML = `  
                        <td>奖池赔付</td>  
                        <td>${hwinM}</td> 
                        <td>${hdrawM}</td>						
                        <td>${hloseM}</td>
                        <td></td>
                    `;
                     row16.innerHTML = `  
                        <td>庄家盈亏</td>  
                        <td>${hwinY}</td> 
                        <td>${hdrawY}</td>						
                        <td>${hloseY}</td>
                        <td></td>
                    `;
                    row9.innerHTML = `   
                        <td colspan="5" style="text-align: center; vertical-align: middle; background: #ff5f5f;">下一场</td> 
                        
                    `; 					
                    tableBody.appendChild(row1);  
					tableBody.appendChild(row2);
					tableBody.appendChild(row3); 
					tableBody.appendChild(row4); 
					tableBody.appendChild(row5); 
					tableBody.appendChild(row6);
					tableBody.appendChild(row7);
					tableBody.appendChild(row8);   
					tableBody.appendChild(row10);
					tableBody.appendChild(row11); 
					tableBody.appendChild(row12); 
					tableBody.appendChild(row13); 
					tableBody.appendChild(row14);
					tableBody.appendChild(row15);
					tableBody.appendChild(row16);
                    tableBody.appendChild(row9);  					
                 }); 
						 } else {  
                    // 请求失败，处理错误  
                    console.error('请求失败，状态码：', xhr2.status);  
                }  
            };  
  
            // 发送GET请求  
            xhr2.open('GET', url2, true);  
            xhr2.send();   
                } else {  
                    // 请求失败，处理错误  
                    console.error('请求失败，状态码：', xhr.status);  
                }  
            };  
  
            // 发送GET请求  
            xhr.open('GET', url, true);  
            xhr.send();  
        } 
function count(num1, num2, symbol){
	let str1 = num1.toString();
	let str2 = num2.toString();
	let result, len1, len2, step;
	try{len1 = str1.split('.')[1].length}catch(e){len1 = 0};
	try{len2 = str2.split('.')[1].length}catch(e){len2 = 0};
	step = Math.pow(10, Math.max(len1, len2));
	let a = parseInt(num1*step);
	let b = parseInt(num2*step);
	switch(symbol){
		case '+':
			result = (a + b) / step
			break;
			case "-":
	            result= (a - b)/step
	            break;
	        case "*":
	            result= (a*b) / step/step
	            break;
	        case "/":
	            result= a/b
	            break;
	        default:
	            break;
	}
	return result;
}	
	</script>  
</head>  

<body>  
 <button onclick="fetchData()">调用API接口</button>  
 <table id="data-table">  
    <thead>  
        <tr>  
            <th></th>  
            <th>胜</th>  
            <th>平</th>
            <th>负</th> 		
            <th></th> 
        </tr>  
    </thead>  
    <tbody id="table-body"></tbody>  
</table>  
</body>  
</html>